(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/createGroupBuyOrder"],{"0ada":function(t,u,r){"use strict";r.r(u);var o=r("4e22"),e=r.n(o);for(var n in o)"default"!==n&&function(t){r.d(u,t,function(){return o[t]})}(n);u["default"]=e.a},"28a6":function(t,u,r){"use strict";(function(t){r("542b"),r("921b");o(r("66fd"));var u=o(r("f2d6"));function o(t){return t&&t.__esModule?t:{default:t}}t(u.default)}).call(this,r("543d")["createPage"])},"4e22":function(t,u,r){"use strict";(function(t){Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var o=r("2f62");function e(t){for(var u=1;u<arguments.length;u++){var r=null!=arguments[u]?arguments[u]:{},o=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),o.forEach(function(u){n(t,u,r[u])})}return t}function n(t,u,r){return u in t?Object.defineProperty(t,u,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[u]=r,t}var i=function(){return r.e("components/uni-popup/uni-popup").then(r.bind(null,"bc88"))},d={data:function(){return{tabCurrentIndex:0,navList:[{state:"1",text:"快递配送"}],quanlificationId:"",groupBuyProductId:"",groupBuyId:"",groupbuy:{},productId:"",product:{},productSkuId:"",productSku:{},productAmount:0,deductAmount:0,actualAmount:0,freightAmount:0,unit:"",addressData:{},merchantData:{},memo:"",type:""}},components:{uniPopup:i},onLoad:function(t){this.quanlificationId=t.quanId,this.groupBuyProductId=t.groupBuyProductId,this.groupBuyId=t.groupBuyId,this.productId=t.productId,this.productSkuId=t.productSkuId,this.unit=t.unit,this.applicationConfig.applicationMerchantEnabled&&this.navList.push({state:"2",text:"门店自提"}),this.inquiryGroupBuyById(this.groupBuyProductId),this.inquiryDefaultAddress(this.userInfo.userUuid)},computed:e({},(0,o.mapState)(["hasLogin","userInfo","applicationConfig"])),watch:{addressData:function(t){this.calculateFreightAmount(this.groupBuyProductId,t.province,t.city,t.area)}},methods:{toActualAmount:function(t,u,r){return(t-u+r).toFixed(2)},tabClick:function(t){this.tabCurrentIndex=t,1==t?this.actualAmount=this.toActualAmount(this.productAmount,this.deductAmount,0):0==t&&(this.actualAmount=this.toActualAmount(this.productAmount,this.deductAmount,this.freightAmount))},inquiryDefaultAddress:function(t){var u=this,r=this,o={userDTO:{userUuid:t}};this.$api.request.userShip(o,function(t){"0"===t.body.status.statusCode?t.body.data.addresses.forEach(function(t,u){t.default&&(r.addressData=t)}):u.$api.msg(t.body.status.errorDesc)})},inquiryGroupBuyById:function(t){var u=this,r=this,o={groupBuyProductUuid:t};this.$api.request.groupBuy(o,function(t){"0"===t.body.status.statusCode?(u.groupbuy=t.body.data,u.product=t.body.data.productDTO,u.productSkuId&&u.product.skuList.forEach(function(t,u){r.productSkuId===t.productSkuUuid&&(r.productSku=t)}),r.productAmount=(r.groupbuy.unitPrice*u.unit).toFixed(2),u.actualAmount=u.toActualAmount(u.productAmount,u.deductAmount,u.freightAmount)):console.log(t.body.status.errorDesc)})},calculateFreightAmount:function(t,u,r,o){var e=this,n={groupBuyProduct:{groupBuyProductUuid:t},orderDTO:{deliveryProvince:u,deliveryCity:r,deliveryArea:o,productUnit:this.unit}};this.$api.request.calculateGroupBuyFreightAmount(n,function(t){"0"===t.body.status.statusCode?(e.freightAmount=t.body.data.orderDTO.freightAmount,e.actualAmount=e.toActualAmount(e.productAmount,e.deductAmount,e.freightAmount)):e.$api.msg(t.body.status.errorDesc)},!1)},calcSelectedProductAmount:function(t){var u=0;return t.forEach(function(t,r){t.productDTO.skuEnabled?u+=t.productSkuDTO.skuUnitPrice*t.unit:u+=t.productDTO.unitPrice*t.unit}),u},change:function(t){console.log("是否打开:"+t.show)},togglePopup:function(t,u){var r=this;switch(t){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}this.type=t,this.$nextTick(function(){r.$refs["show"+u].open()})},submit:function(){var u=this;if(0!=this.tabCurrentIndex||this.addressData.userDeliveryAddressUuid)if(1!=this.tabCurrentIndex||this.merchantData.merchantUuid){var r={groupBuyUuid:this.groupBuyId,groupBuyProduct:{groupBuyProductUuid:this.groupBuyProductId},orderDTO:{userDTO:{userUuid:this.userInfo.userUuid},deliveryAddressDTO:{userDeliveryAddressUuid:this.addressData.userDeliveryAddressUuid},merchantDTO:{merchantUuid:this.merchantData.merchantUuid},productUnit:this.unit,deliveryType:0==this.tabCurrentIndex?"1":"2"},productDTO:{productUuid:this.productId},productSkuDTO:{productSkuUuid:this.productSkuId},owner:null!=this.groupBuyId&&""!=this.groupBuyId};this.$api.request.createGroupBuyOrder(r,function(r){"0"===r.body.status.statusCode?t.redirectTo({url:"/pages/money/pay?orderNo="+r.body.data.orderNo}):u.$api.msg(r.body.status.errorDesc)})}else this.$api.msg("未选择提货门店");else this.$api.msg("未选择收货地址")},stopPrevent:function(){}}};u.default=d}).call(this,r("543d")["default"])},"65ef":function(t,u,r){"use strict";var o=r("9d61"),e=r.n(o);e.a},7952:function(t,u,r){"use strict";var o=function(){var t=this,u=t.$createElement;t._self._c},e=[];r.d(u,"a",function(){return o}),r.d(u,"b",function(){return e})},"9d61":function(t,u,r){},f2d6:function(t,u,r){"use strict";r.r(u);var o=r("7952"),e=r("0ada");for(var n in e)"default"!==n&&function(t){r.d(u,t,function(){return e[t]})}(n);r("65ef");var i=r("2877"),d=Object(i["a"])(e["default"],o["a"],o["b"],!1,null,null,null);u["default"]=d.exports}},[["28a6","common/runtime","common/vendor"]]]);