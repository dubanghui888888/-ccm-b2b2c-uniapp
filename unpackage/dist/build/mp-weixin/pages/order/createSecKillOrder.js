(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/createSecKillOrder"],{1574:function(t,e,u){"use strict";u.r(e);var i=u("c0f1"),n=u("fe53");for(var o in n)"default"!==o&&function(t){u.d(e,t,function(){return n[t]})}(o);u("1667");var r=u("2877"),c=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},1667:function(t,e,u){"use strict";var i=u("6272"),n=u.n(i);n.a},"4b22":function(t,e,u){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u("2f62");function n(t){for(var e=1;e<arguments.length;e++){var u=null!=arguments[e]?arguments[e]:{},i=Object.keys(u);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(u).filter(function(t){return Object.getOwnPropertyDescriptor(u,t).enumerable}))),i.forEach(function(e){o(t,e,u[e])})}return t}function o(t,e,u){return e in t?Object.defineProperty(t,e,{value:u,enumerable:!0,configurable:!0,writable:!0}):t[e]=u,t}var r=function(){return u.e("components/uni-popup/uni-popup").then(u.bind(null,"bc88"))},c={data:function(){return{tabCurrentIndex:0,navList:[{state:"1",text:"快递配送"}],quanlificationId:"",seckillId:"",seckill:{},productId:"",product:{},productSkuId:"",productSku:{},productAmount:0,deductAmount:0,actualAmount:0,freightAmount:0,addressData:{},merchantData:{},memo:"",type:""}},components:{uniPopup:r},onLoad:function(t){this.quanlificationId=t.quanId,this.seckillId=t.seckillId,this.productId=t.productId,this.productSkuId=t.productSkuId,this.applicationConfig.applicationMerchantEnabled&&this.navList.push({state:"2",text:"门店自提"}),this.inquirySeckillById(this.seckillId),this.inquiryDefaultAddress(this.userInfo.userUuid)},computed:n({},(0,i.mapState)(["hasLogin","userInfo","applicationConfig"])),watch:{addressData:function(t){this.calculateFreightAmount(this.seckillId,t.province,t.city,t.area)}},methods:{toActualAmount:function(t,e,u){return(t-e+u).toFixed(2)},tabClick:function(t){this.tabCurrentIndex=t,1==t?this.actualAmount=this.toActualAmount(this.productAmount,this.deductAmount,0):0==t&&(this.actualAmount=this.toActualAmount(this.productAmount,this.deductAmount,this.freightAmount))},inquiryDefaultAddress:function(t){var e=this,u={userDTO:{userUuid:t}};this.$api.request.userShip(u,function(t){"0"===t.body.status.statusCode?t.body.data.addresses.forEach(function(t,u){t.default&&(e.addressData=t)}):console.log(t.body.status.errorDesc)})},inquirySeckillById:function(t){var e=this,u=this,i={secKillProductUuid:t};this.$api.request.secKillDetail(i,function(t){"0"===t.body.status.statusCode?(e.seckill=t.body.data,e.product=t.body.data.productDTO,e.productSkuId&&e.product.skuList.forEach(function(t,e){u.productSkuId===t.productSkuUuid&&(u.productSku=t)}),u.productAmount=u.seckill.unitPrice.toFixed(2),e.actualAmount=e.toActualAmount(e.productAmount,e.deductAmount,e.freightAmount)):console.log(t.body.status.errorDesc)})},calculateFreightAmount:function(t,e,u,i){var n=this,o={secKillProduct:{secKillProductUuid:t},orderDTO:{deliveryProvince:e,deliveryCity:u,deliveryArea:i}};this.$api.request.calculateSecKillFreightAmount(o,function(t){"0"===t.body.status.statusCode?(n.freightAmount=t.body.data.orderDTO.freightAmount,n.actualAmount=n.toActualAmount(n.productAmount,n.deductAmount,n.freightAmount)):n.$api.msg(t.body.status.errorDesc)},!1)},calcSelectedProductAmount:function(t){var e=0;return t.forEach(function(t,u){t.productDTO.skuEnabled?e+=t.productSkuDTO.skuUnitPrice*t.unit:e+=t.productDTO.unitPrice*t.unit}),e},change:function(t){console.log("是否打开:"+t.show)},togglePopup:function(t,e){var u=this;switch(t){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}this.type=t,this.$nextTick(function(){u.$refs["show"+e].open()})},submit:function(){var e=this;if(0!=this.tabCurrentIndex||this.addressData.userDeliveryAddressUuid)if(1!=this.tabCurrentIndex||this.merchantData.merchantUuid){var u={secKillProduct:{secKillProductUuid:this.seckillId},orderDTO:{userDTO:{userUuid:this.userInfo.userUuid},deliveryAddressDTO:{userDeliveryAddressUuid:this.addressData.userDeliveryAddressUuid},merchantDTO:{merchantUuid:this.merchantData.merchantUuid},deliveryType:0==this.tabCurrentIndex?"1":"2"},productDTO:{productUuid:this.productId},productSkuDTO:{productSkuUuid:this.productSkuId},quanlificationId:this.quanlificationId};this.$api.request.createSecKillOrder(u,function(u){"0"===u.body.status.statusCode?t.redirectTo({url:"/pages/money/pay?orderNo="+u.body.data.orderNo}):e.$api.msg(u.body.status.errorDesc)})}else this.$api.msg("未选择提货门店");else this.$api.msg("未选择收货地址")},stopPrevent:function(){}}};e.default=c}).call(this,u("543d")["default"])},6272:function(t,e,u){},"9ea0":function(t,e,u){"use strict";(function(t){u("542b"),u("921b");i(u("66fd"));var e=i(u("1574"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,u("543d")["createPage"])},c0f1:function(t,e,u){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},n=[];u.d(e,"a",function(){return i}),u.d(e,"b",function(){return n})},fe53:function(t,e,u){"use strict";u.r(e);var i=u("4b22"),n=u.n(i);for(var o in i)"default"!==o&&function(t){u.d(e,t,function(){return i[t]})}(o);e["default"]=n.a}},[["9ea0","common/runtime","common/vendor"]]]);